<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Legal Services Template</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
body{
  margin:0;
  background:#0b0b10;
  color:#f5f5f5;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
}
.page{max-width:1080px;margin:0 auto;padding:24px 16px 64px}

nav{display:flex;gap:20px;margin-bottom:28px}
nav a{color:#fff;text-decoration:none;opacity:.65}
nav a.active{opacity:1;text-decoration:underline}

section{margin-top:40px}
.hero{
  padding:42px 26px;
  border-radius:18px;
  background:radial-gradient(circle at top left,#3b82f6,#0b1220 65%,#0b0b10);
}
.hero-kicker{font-size:.85rem;text-transform:uppercase;letter-spacing:.14em;opacity:.75}
.hero-title{font-size:2.3rem;margin:14px 0 10px}
.hero-subtitle{max-width:560px;opacity:.9}
.hero-cta{margin-top:22px;display:flex;gap:12px}
.btn-primary,.btn-secondary{
  padding:10px 22px;border-radius:999px;border:none;cursor:pointer;font-size:.95rem
}
.btn-primary{background:#3b82f6;color:#fff}
.btn-secondary{background:transparent;border:1px solid rgba(255,255,255,.25);color:#fff}

.pill-row{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap}
.pill{font-size:.8rem;padding:6px 12px;border-radius:999px;background:rgba(255,255,255,.08)}

.section-box{
  background:rgba(255,255,255,.04);
  padding:26px 22px;
  border-radius:18px
}
.section-title{font-size:1.5rem;margin-bottom:8px}
.section-subtitle{opacity:.85;margin-bottom:14px}

.grid-3{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:18px
}
.card{
  padding:16px 14px;
  border-radius:14px;
  background:rgba(0,0,0,.45);
  border:1px solid rgba(255,255,255,.06)
}
.badge{
  font-size:.7rem;
  text-transform:uppercase;
  letter-spacing:.14em;
  opacity:.7;
  margin-bottom:6px
}
.contact-list{list-style:none;padding:0;margin:0}
.contact-list li{margin-bottom:6px}
</style>
</head>

<body>
<div class="page">

<!-- NAV -->
<nav id="nav"></nav>

<!-- HERO -->
<section data-block="hero" class="hero">
  <div class="hero-kicker" id="hero-kicker"></div>
  <h1 class="hero-title" id="hero-headline"></h1>
  <p class="hero-subtitle" id="hero-subheadline"></p>
  <div class="hero-cta">
    <button class="btn-primary" id="hero-cta-primary"></button>
    <button class="btn-secondary" id="hero-cta-secondary"></button>
  </div>
  <div class="pill-row">
    <span class="pill" id="hero-pill-1"></span>
    <span class="pill" id="hero-pill-2"></span>
    <span class="pill" id="hero-pill-3"></span>
  </div>
</section>

<!-- ABOUT -->
<section data-block="about" class="section-box">
  <h2 class="section-title" id="about-title"></h2>
  <p class="section-subtitle" id="about-tagline"></p>
  <p id="about-paragraph-1"></p>
  <p id="about-paragraph-2"></p>
  <p id="about-paragraph-3"></p>

  <div class="card" style="margin-top:20px">
    <div class="badge" id="why-badge"></div>
    <h3 id="why-title"></h3>
    <p id="why-text-1"></p>
    <p id="why-text-2"></p>
    <p id="why-text-3"></p>
  </div>
</section>

<!-- SERVICES -->
<section data-block="services" class="section-box">
  <h2 class="section-title" id="services-title"></h2>
  <p class="section-subtitle" id="services-subtitle"></p>
  <div class="grid-3">
    <div class="card"><h4 id="service-1-title"></h4><p id="service-1-description"></p></div>
    <div class="card"><h4 id="service-2-title"></h4><p id="service-2-description"></p></div>
    <div class="card"><h4 id="service-3-title"></h4><p id="service-3-description"></p></div>
  </div>
</section>

<!-- OFFERS -->
<section data-block="offers" class="section-box">
  <h2 class="section-title" id="offers-title"></h2>
  <p class="section-subtitle" id="offers-subtitle"></p>
  <div class="grid-3">
    <div class="card">
      <div class="badge" id="offer-1-badge"></div>
      <h4 id="offer-1-name"></h4>
      <small id="offer-1-price"></small>
      <p id="offer-1-description"></p>
    </div>
    <div class="card">
      <div class="badge" id="offer-2-badge"></div>
      <h4 id="offer-2-name"></h4>
      <small id="offer-2-price"></small>
      <p id="offer-2-description"></p>
    </div>
    <div class="card">
      <div class="badge" id="offer-3-badge"></div>
      <h4 id="offer-3-name"></h4>
      <small id="offer-3-price"></small>
      <p id="offer-3-description"></p>
    </div>
  </div>
</section>

<!-- CONTACT -->
<section data-block="contact" class="section-box">
  <h2 class="section-title" id="contact-title"></h2>
  <p class="section-subtitle" id="contact-subtitle"></p>
  <ul class="contact-list">
    <li id="contact-phone"></li>
    <li id="contact-address"></li>
    <li id="contact-hours-line-1"></li>
    <li id="contact-hours-line-2"></li>
    <li id="contact-hours-line-3"></li>
  </ul>
</section>

</div>

<script type="module">
import { createClient } from "https://esm.sh/@supabase/supabase-js@2";
const supabase = createClient("https://xkchlqcwntcoakmyicqb.supabase.co","PUBLIC_ANON_KEY");

const qs = k => new URLSearchParams(location.search).get(k);
const page = () => qs("page") || "home";

async function load(){
  const { data } = await supabase
    .from("projects")
    .select("content_json")
    .eq("id", qs("project_id"))
    .single();
  if(!data?.content_json) return;
  const c = data.content_json;

  // NAV
  const nav = document.getElementById("nav");
  nav.innerHTML = "";
  Object.keys(c.pages || {}).forEach(p=>{
    const a=document.createElement("a");
    a.href=`?project_id=${qs("project_id")}&page=${p}`;
    a.textContent=p.charAt(0).toUpperCase()+p.slice(1);
    if(p===page()) a.classList.add("active");
    nav.appendChild(a);
  });

  // PAGE LOGIC
  document.querySelectorAll("[data-block]").forEach(el=>{
    el.style.display = c.pages?.[page()]?.includes(el.dataset.block)
      ? "block":"none";
  });

  // HERO
  if(c.home?.hero){
    hero_kicker.textContent=c.home.hero.kicker;
    hero_headline.textContent=c.home.hero.headline;
    hero_subheadline.textContent=c.home.hero.subheadline;
    hero_cta_primary.textContent=c.home.hero.primary_cta;
    hero_cta_secondary.textContent=c.home.hero.secondary_cta;
    c.home.hero.pills?.forEach((p,i)=>{
      const el=document.getElementById(`hero-pill-${i+1}`);
      if(el) el.textContent=p;
    });
  }

  // ABOUT
  if(c.about){
    about_title.textContent=c.about.title;
    about_tagline.textContent=c.about.tagline;
    c.about.paragraphs?.forEach((p,i)=>{
      const el=document.getElementById(`about-paragraph-${i+1}`);
      if(el) el.textContent=p;
    });
    why_badge.textContent=c.about.why_badge;
    why_title.textContent=c.about.why_title;
    c.about.why_points?.forEach((p,i)=>{
      const el=document.getElementById(`why-text-${i+1}`);
      if(el) el.textContent=p;
    });
  }

  // SERVICES
  if(c.services){
    services_title.textContent=c.services.title;
    services_subtitle.textContent=c.services.subtitle;
    c.services.items?.forEach((s,i)=>{
      document.getElementById(`service-${i+1}-title`).textContent=s.title;
      document.getElementById(`service-${i+1}-description`).textContent=s.description;
    });
  }

  // OFFERS
  if(c.offers){
    offers_title.textContent=c.offers.title;
    offers_subtitle.textContent=c.offers.subtitle;
    c.offers.deals?.forEach((d,i)=>{
      document.getElementById(`offer-${i+1}-badge`).textContent=d.badge;
      document.getElementById(`offer-${i+1}-name`).textContent=d.name;
      document.getElementById(`offer-${i+1}-price`).textContent=d.price_text;
      document.getElementById(`offer-${i+1}-description`).textContent=d.description;
    });
  }

  // CONTACT
  if(c.contact){
    contact_title.textContent=c.contact.title;
    contact_subtitle.textContent=c.contact.subtitle;
    contact_phone.textContent=c.contact.phone;
    contact_address.textContent=c.contact.address;
    c.contact.hours_lines?.forEach((h,i)=>{
      const el=document.getElementById(`contact-hours-line-${i+1}`);
      if(el) el.textContent=h;
    });
  }
}

window.addEventListener("DOMContentLoaded", load);
window.addEventListener("message", e=>{
  if(e.data?.type==="content-updated") load();
});
</script>
</body>
</html>
