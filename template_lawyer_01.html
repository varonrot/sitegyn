<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sitegyn Multi Page Template</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      background:#0b0b10;
      color:#f5f5f5;
    }

    .page {
      max-width:1080px;
      margin:0 auto;
      padding:24px 16px 64px;
    }

    nav {
      display:flex;
      gap:16px;
      margin-bottom:24px;
    }

    nav a {
      color:#fff;
      text-decoration:none;
      opacity:.7;
    }

    nav a.active {
      opacity:1;
      text-decoration:underline;
    }

    section[data-page] { display:none; }

    .hero {
      padding:40px 24px;
      border-radius:16px;
      background:radial-gradient(circle at top left,#ff5c3b,#2b0b10 60%,#0b0b10);
    }

    .hero-kicker {
      font-size:.85rem;
      text-transform:uppercase;
      letter-spacing:.12em;
      opacity:.8;
    }

    .hero-title {
      font-size:2.4rem;
      margin:12px 0 8px;
    }

    .hero-subtitle {
      max-width:560px;
      opacity:.9;
    }

    .hero-cta {
      margin-top:20px;
      display:flex;
      gap:12px;
      flex-wrap:wrap;
    }

    .btn-primary,.btn-secondary {
      border-radius:999px;
      padding:10px 22px;
      cursor:pointer;
      border:none;
    }

    .btn-primary {
      background:#ff5c3b;
      color:#fff;
    }

    .btn-secondary {
      background:transparent;
      border:1px solid rgba(255,255,255,.25);
      color:#fff;
    }

    .pill-row {
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:14px;
    }

    .pill {
      font-size:.8rem;
      padding:6px 10px;
      border-radius:999px;
      background:rgba(255,255,255,.08);
    }

    .section {
      margin-top:40px;
      padding:24px 20px;
      border-radius:16px;
      background:rgba(255,255,255,.03);
    }

    .section-title {
      font-size:1.4rem;
      margin-bottom:6px;
    }

    .section-subtitle {
      opacity:.85;
      margin-bottom:12px;
    }

    .contact-list {
      list-style:none;
      padding:0;
      margin:10px 0 0;
      line-height:1.6;
    }
  </style>
</head>

<body>
<div class="page">

  <!-- NAV -->
  <nav>
    <a href="?page=home" data-page="home" class="nav-link">Home</a>
    <a href="?page=contact" data-page="contact" class="nav-link">Contact</a>
  </nav>

  <!-- HOME -->
  <section data-page="home">

    <div class="hero">
      <div class="hero-kicker" id="hero-kicker"></div>
      <h1 class="hero-title" id="hero-headline"></h1>
      <p class="hero-subtitle" id="hero-subheadline"></p>

      <div class="hero-cta">
        <button class="btn-primary" id="hero-cta-primary"></button>
        <button class="btn-secondary" id="hero-cta-secondary"></button>
      </div>

      <div class="pill-row">
        <span class="pill" id="hero-pill-1"></span>
        <span class="pill" id="hero-pill-2"></span>
        <span class="pill" id="hero-pill-3"></span>
      </div>
    </div>

    <div class="section">
      <h2 class="section-title" id="about-title"></h2>
      <p class="section-subtitle" id="about-tagline"></p>
      <p id="about-paragraph-1"></p>
      <p id="about-paragraph-2"></p>
      <p id="about-paragraph-3"></p>
    </div>

  </section>

  <!-- CONTACT -->
  <section data-page="contact">
    <div class="section">
      <h2 class="section-title" id="contact-title"></h2>
      <p class="section-subtitle" id="contact-subtitle"></p>
      <ul class="contact-list">
        <li id="contact-phone"></li>
        <li id="contact-address"></li>
        <li id="contact-hours-line-1"></li>
        <li id="contact-hours-line-2"></li>
        <li id="contact-hours-line-3"></li>
      </ul>
    </div>
  </section>

</div>

<script type="module">
import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

const supabase = createClient(
  "https://xkchlqcwntcoakmyicqb.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhrY2hscWN3bnRjb2FrbXlpY3FiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI4MDMyNzEsImV4cCI6MjA3ODM3OTI3MX0.702fpZLEHukvswrY0uwHknQYwdNDW-HeNsQxu_f1NnU"
);

const $ = id => document.getElementById(id);

function currentPage() {
  return new URLSearchParams(location.search).get("page") || "home";
}

function renderPage() {
  const page = currentPage();

  document.querySelectorAll("section[data-page]").forEach(sec => {
    sec.style.display = sec.dataset.page === page ? "block" : "none";
  });

  document.querySelectorAll(".nav-link").forEach(a => {
    a.classList.toggle("active", a.dataset.page === page);
  });
}

async function loadContent() {
  const projectId = new URLSearchParams(location.search).get("project_id");
  if (!projectId) return;

  const { data } = await supabase
    .from("projects")
    .select("content_json")
    .eq("id", projectId)
    .single();

  if (!data?.content_json) return;

  const c = data.content_json;

  // HERO
  $("hero-kicker").innerText = c.home?.hero?.kicker || "";
  $("hero-headline").innerText = c.home?.hero?.headline || "";
  $("hero-subheadline").innerText = c.home?.hero?.subheadline || "";
  $("hero-cta-primary").innerText = c.home?.hero?.primary_cta || "";
  $("hero-cta-secondary").innerText = c.home?.hero?.secondary_cta || "";

  c.home?.hero?.pills?.forEach((p,i)=>{
    const el = $("hero-pill-"+(i+1));
    if(el) el.innerText = p;
  });

  // ABOUT
  $("about-title").innerText = c.about?.title || "";
  $("about-tagline").innerText = c.about?.tagline || "";

  c.about?.paragraphs?.forEach((p,i)=>{
    const el = $("about-paragraph-"+(i+1));
    if(el) el.innerText = p;
  });

  // CONTACT
  $("contact-title").innerText = c.contact?.title || "";
  $("contact-subtitle").innerText = c.contact?.subtitle || "";
  $("contact-phone").innerText = c.contact?.phone || "";
  $("contact-address").innerText = c.contact?.address || "";

  c.contact?.hours_lines?.forEach((h,i)=>{
    const el = $("contact-hours-line-"+(i+1));
    if(el) el.innerText = h;
  });

  renderPage();
}

window.addEventListener("message", e => {
  if (e.data?.type === "content-updated") loadContent();
});

document.addEventListener("DOMContentLoaded", loadContent);
</script>

</body>
</html>
